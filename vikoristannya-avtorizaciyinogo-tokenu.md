# Використання авторизаціїного токену

Після розшифрування JWE відповіді (Детальніше: [Приклад розшифрування](https://docs.merchant.alb.ua/autentifikaciya#proces-rozshifruvannya-jwe-danikh)) на запит авторизації `"/api-gateway/authorize_virtual_device"`, отримуємо сесійний токен, а також його термін життя у параметрах:

* "tokenExpirationDateTime": "2025-02-27 12:12:34.0430 +0000" // UTC+00:00
* "tokenExpiration": "2025-02-27 14:12:34.430+02:00" // UTC+02:00 Kyiv

Загальний термін дії авторизації 24 години з моменту виконання запиту на аторизацію `"/api-gateway/authorize_virtual_device"`&#x20;

Рекомендовано виконувати авторизацію раз у 8 або 12 або 24 години, для зменьшення помилок під час експлатації авторизаційного токену. &#x20;

> Примітка! Не потрібно для кожного запиту виконувати нову авторизацію&#x20;

**Можливі проблеми:**

1. Просроченний авторизаційний токен через неактивність
   * При відсутності активності `serviceCode` більше ніж 200 днів, доступ до API автоматично закривається.
   * При спробі виконати запит на авторизацію `"/api-gateway/authorize_virtual_device"` виникає помилка : `"b_auth_token_expired"`.
   * У випадку необхідності вирішення проблеми, потрібно звернутись до служби підтримку.
   * **Після виправлення проблеми**, у відповіді на авторизацію надійдуть нові параметри, які потрібно оновити, перед подальшим використання API запитів.
2. Простроченний поточний токен
   * У випадку виникнення помилки `"b_expired_token"`.
   * Потрібно виконати запит на авторизацію `"/api-gateway/authorize_virtual_device"`.
3. Просроченний поточний сеанс&#x20;
   * Виникнення помилки  `"b_session_doesnt_exists"`  з текстом "Сеансу не існує".
   * Помилка з'являється,  коли використовується данні попереднього сеансу.
   * Для вирішення проблеми, потрібно виконати запит на авторизацію `"/api-gateway/authorize_virtual_device"` , та використовувати нові дані сеансу.&#x20;
